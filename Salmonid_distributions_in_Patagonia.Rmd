---
title: 'Assembly of non-native fishes in North Patagonian streams: Species occurrence and abundance respond to different spatial scales'
author: "Mailén E. Lallement, Magalí Rechencq and Eduardo E. Zattara"
date: "11/24/2022"
bibliography: references.json
csl: ecology-of-freshwater-fish.csl
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries, include=FALSE}
#Load libraries
library(tidyverse) # The tidyverse set of packages
library(gt) # A layered 'grammar of tables' - think ggplot, but for tables
library(VennDiagram)
library("Hmisc")
library(factoextra)
```

## Abstract

Ecological communities are structured by combinations of biotic and abiotic factors acting at different spatial scales. However, the relative influence of the different scale-related variables on assemblage composition is poorly understood, despite being key to the effective and efficient management of fluvial ecosystems. We took advantage of the relatively recent and well-studied history of salmonid introductions in Patagonia to evaluate if non-native species show different patterns of association with abiotic factors depending on the spatial scale of the environmental filter. We used a hierarchical approach to characterised environmental variables at the basin and reach scales to assess their influence on the presence, abundance and structure of the salmonid assemblages in breeding streams. We saw no evidence that presence/absence patterns of salmonid distribution were driven by landscape variables, except for those basins with physical environmental barriers to colonisation. However, we did find evidence for relative abundances being influenced by climatic and geomorphological variables (e.g., precipitation and relief). Our results do not support a scenario in which any of the salmonid species modulates the distribution of the other species, suggesting that interference has played only a minor role in determining current fish distribution in fluvial systems of the region. Instead, current patterns of presence and abundance of salmonids are best explained as the product of environmental filters. Our findings contribute to our understanding of the ecology of individual species and provide insight into the mechanisms structuring fish assemblages in Southern Hemisphere's lotic systems.

## Introduction

Ecological communities are structured by combinations of factors acting at different spatial scales that mould evolutionary forces and structure ecological strategies for each of the species within the community. In other words, both the presence of a species at a particular site and its life history strategy are the result of environmental filtering (i.e., the tolerance of the species to a particular subset of biotic and abiotic characteristics) and trade-offs met during habitat adaptation.

Fluvial ecosystems are characterized by a physical habitat strongly influenced by the inherent hierarchical structure and patchiness that determine the distribution of organisms, food availability, predation and competition [@frissellHierarchicalFrameworkStream1986b; @schlosserSpatialVariationFish2000a] . Fine-scaled variability results from the interaction between large-scale landscape variables (e.g., basin area, slope profile of stream-associated valleys and other geomorphological traits) and smaller scale variables (e.g., local structure and condition) [@frissellHierarchicalFrameworkStream1986b; @schlosserSpatialVariationFish2000a]. Because of that, defining which habitat variables and spatial scales have the most influence on freshwater communities is key to effective and efficient management of fluvial ecosystems [@matthewsPatternsFreshwaterFish1998a; @gidoFishhabitatRelationsSpatial2006a].

Environmental filtering is considered a major structuring mechanism of communities [@weiherAssemblyExperimentalWetland1995]. It is dominated by three ecological factors: dispersal restriction, abiotic environment and biotic interactions [@belyeaAssemblyContingentRules1999]. The first two act on a regional scale and delimit the area of action of the third, which operates on a local scale [@boothAssemblyTheoryApplied2002] . While the utility of the environmental filtering concept has been disputed on the basis that it predicts patterns that cannot be distinguished from those produced by other mechanisms, such as competition [@kraftCommunityAssemblyCoexistence2015a], there are good reasons to explore how patterns of trait or phylogenetic dispersion change in response to the environment [@cadotteShouldEnvironmentalFiltering2017]. Therefore, if the relative effects of these general classes of factors in streams could be disentangled, then we would gain a comprehensive view of how each factor drives community composition in hierarchical systems as streams.

In Patagonia, particularly at the scale of large drainage basins, fish distribution has been strongly influenced by the Andean uplift and the Quaternary glacial cycles [@hubertHistoricalBiogeographySouth2006a] . After the retreat of glaciers during the Pleistocene, the ability of Patagonian fish to colonize post-glacial water bodies determined their present distribution, clearly constrained by climate, especially by temperature [@ruzzantePhylogeographyPercichthyidaePisces2006; @cussacFishesSouthernSouth2009]. In recent times, native freshwater fish communities have also been altered on repeated occasions by the introduction of non-native species to generate sport fisheries, resulting in communities where up to six native species and four introduced salmonid species coexist within the watershed [@macchiPredationRelationshipsIntroduced1999b]. Many of these species have stable populations at several large lakes that have been intensively studied in the past years [@cussacAbundanceNativeFishes2014]. However, little is known about the original distribution of fish assemblages in streams or about the environmental filters that structure current riverine communities [@pascualFreshwaterFishesPatagonia2007a; @aigoDistributionIntroducedNative2008a; @barrigaImportanceSubstrateSize2013; @lallementLandscapeFactorsModulating].

Of the four species introduced to continental Patagonia since 1904, rainbow trout (*Onchorhynchus mykiss*, Walbaum 1792), brown trout (*Salmo trutta*, Linnaeus 1758) and brook trout (*Salvelinus fontinalis*, Mitchill 1814) are currently the most widely distributed and abundant species. The rapid adaptation of these salmonid species to the new environment enabled them to establish self-sustaining populations, obviating the need for continuous import of eggs and ensuring of a steady supply of fish from local reproducers. The short and well-known history of introductions in the region shows these species have high dispersive capabilities and found practically no biological resistance to invasion [@pascualFreshwaterFishesPatagonia2007a]. Thus, it can be posited that their current distribution in Patagonia resulted mainly from environmental filtering at different scales. Although the influence of the landscape scale factors has been observed for the two most abundant species of salmonids in previous works [@aigoDistributionIntroducedNative2008a; @lallementLandscapeFactorsModulating], it is uncertain if these factors alone explain the richness of non-native species in the watershed.

The objective of this work was to examine watershed and reach-level patterns of introduced salmonid species in North Patagonian rivers and their association with watershed characteristics derived from remote sensing and topography data across an environmental gradient. We compared the relative variation in salmonid density across different kind of watersheds expecting that some environmental characteristics at a landscape and reach scale conditioned i) the presence of each salmonid species, ii) the abundance of each species, iii) the assemblage conformation and iv) the dominance of a species at a regional level. We characterized environmental variables at the basin and reach scale to assess their influence on the presence, abundance and structure of the salmonid assemblages in breeding streams of the Upper Limay river basin. Our findings contribute to our understanding of the ecology of individual species and provide insight into mechanisms structuring fish assemblages in Southern Hemisphere's stream systems that could inform conservation and management activities.

## Methods

### Study Area

The Upper Limay River basin is located between the provinces of Río Negro and Neuquén (\~40°63' S, 71° 70' W), Argentina, and drains an area of 6.980 km^2^, most of it within the boundaries of Nahuel Huapi National Park (Figure 1). Originating in the eastern slopes of the Andes mountain range, the basin presents a complex hydrological network, with many streams, rivers and lentic water bodies. Due to rain-shadowing effects by the Andes, the area experiences a steep longitudinal climatic gradient going from 3000 mm of yearly precipitation in the West to less than 600 mm to the East in about 60 km [@parueloClimatePatagoniaGneral1998]. This climatic gradient results in an eastward transition from a cold-temperate rainforest to shrubby dry steppes. The watershed has a highly connected, complex hydrologic network characterized by deep oligotrophic lakes of varying size, interconnected by streams, ponds and wetlands. The main hub of the network is Nahuel Huapi Lake, with an area of 529 km^2^ and a maximum depth of 464 m, which collects most waters from the basin, and drains through the Limay River towards the Atlantic Ocean (Figure 1).

![Figure 1. Sampling sites in each watershed in the Upper Limay river Basin: 1, Neuquenco; 2, Acantuco; 3, Pireco; 4, Machete; 5, Gallardo; 6, Coluco; 7, Bravo; 8, Blanco; 9, Millaqueo; 10, Blest; 11, Patiruco; 12, Frey; 13, Uhueco; 14, Lluvuco; 15, Bonito; 16, Estacada; 17, Ragintuco; 18, Huemul; 19, Pedregoso; 20, Quintriquenco; 21, Manzano-Jones; 22, Newbery; 23, Chacabuco; 24, Castilla; 25, Casa de Piedra; 26, Cascada; 27, Gutierrez; 28, Ñireco; 29, del Medio; 30, Torrontegui; 31, Tristeza; 32, Challhuaco; 33, Ñirihuau; 34, Las Minas; 35, de las Quebradas. Black dots are sampled reaches.](Figura1_Lallement-et-al.png){#fig:mapa-cuencas}

### Selection of watersheds

Thirty-five basins fully representing the environmental gradient of the watershed were selected for this study (Figure 1). For each basin, one or more sections of 2nd order or higher were selected; selection criteria were size, registered physiographic changes, existence of natural or anthropic barriers and the accessibility to each section [@bainAquaticHabitatAssessment1999]. Based on these criteria, some basins were represented by a single section, while others had two or more representative sections. On larger basins with enough altitudinal range (e.g., Machete, Gutiérrez, Ñireco, Ñirihauau and Chacabuco), additional sections on tributary streams were sampled.

### Watershed variables

A total of 32 watershed attributes were chosen following the available literature [@angermeierCharacterizingFishCommunity1999; @oakesModellingStreamFishes2005; @smithStreamFishAssemblages2005a], and were grouped into four distinct categories (Geomorphological, Climatological, Land Use and Vegetation) based on the general aspect of the environment measured by each variable. All categories were calculated using GIS tools (version 2.6) under the QGIS environment (QGIS Development Team, 2014), or using specific formulas following @bainAquaticHabitatAssessment1999. Land Use and Vegetation data were obtained from existing digital map layers available from the National Geographic Institute, the National Institute of Agricultural Technology (INTA) and National Parks Administration's Biodiversity Information System; these maps were complemented with satellite imagery from Google Earth. Watershed morphological variables were calculated based on a digital elevation model with a resolution of 30 m (Landsat 6TM+). Average annual precipitation (mm) and temperature were calculated based on a map interpolating averages of daily measures from 25 meteorological stations located within from 38°46'0S--41°30'0S and 70°03'0W--71°45'0W [@barrosCartasPrecipitacionZona1983]. The Normalized Differential Vegetation Index (NDVI) was calculated from Landsat 6TM+ satellite images during the summer season of 2014. Geoprocessing and zonal statistics were computed using Quantum Gis (QGIS) (version 2.6) and digital map data.

```{r}
#TABLE 1 - Basin-level variables
basins <- read_csv("basins.csv")
gt(basins)
```

### Local Variables

Physicochemical variables were collected in 42 reaches. Variables included geomorphological, substrate type, hydrological and water quality . Location and number of sections sampled by stream were determined by the pattern shape of channels, covered area and accessibility, which determined that streams with the largest area have a greater number of sections sampled. Thus, sections were selected based on particular characteristics of each stream such as changes in the relief or riverine vegetation, tributary unions and presence of ponds or waterfalls.

```{r}
#TABLE 2 - Reach-level variables
reach <- read_tsv("reaches.tsv")
gt(reach)
```

### Fish Capture

Different stream segments that presented a succession of pool-riffle-pool habitats were sampled during the austral summer (from December to March) of 2013-2014. The minimum sampled area depended on the size of the selected reach. In each section, presence-absence data were collected by three-pass electrofishing with a Smith-Root mod 12B equipment along 50-m reach. Relative abundance, expressed as catch per unit effort (CPUEN), was standardized based on actual length of each sweep to number of fish caught per 100 m^2^. Electrofishing was conducted following an upstream zigzag trajectory and exploring all habitat types. The extremes of the trajectory were not blocked with nets. For basins sampled in more than one section, an average of the CPUEN of all sampled sections was used as basin-level fish abundance. The Administration of Nahuel Huapi National Park and San Carlos de Bariloche Town Council approved our protocols and procedures and granted permission to collect fish samples (APN project n° 1173 and S.C de Bariloche Council note n° 412/SSMA/15).

### Analysis of data

Influence of the presence of a given species on the chance of other species being present was tested using a contingency table approach, asking whether the probability of a species being present was contingent on the presence of other species. We calculated the expected counts for each unique combination of species (including basins with no species at all) assuming that the frequency of each combination is the product of the probability of each species to be present, and compared them to the observed counts using a Fisher´s exact Test for contingency tables.

We then used generalized linear models (GLMs) on presence/absence and relative abundance data to assess the filtering influence of landscape and local variables. For each level and response variable type, we tried two approaches: 1) reducing the dimensionality of the independent variables through a principal components analysis, and then using the principal components explaining most variance as predictor variables in the GLM; and 2) by selecting independent variables that were not significantly correlated and using them as predictor variables in the GLM. While these two approaches are expected to yield qualitatively similar results, the second approach lends to more straightforward interpretations. All analyses were run using the function glm from the base package of the R computing environment R Core Team, version 3.5.1 (2018). To regress environmental variables using presence/absence as a response variable, we used a binomial logistic regression with a logit link. When the response variable was the logarithm of relative abundance, we used a Gaussian regression with an identity link.

## Results

### Introduced salmonid species are unevenly distributed among basins

Only two specimens of native species were caught: one of *Galaxias maculatus* (Jennyns, 1842) in the Frey basin and another of *Hatcheria macraei* (Girard, 1885) in the Ñirihuau basin. In contrast, a total of 4531 salmonids were caught. We found individuals aged between 0 and 3 years old at all sites, but older specimens (up to 8 years old) were caught only in some of the Eastern basins. No fish were captured in the Newbery, Blanco, Bravo and Uhueco basins; these streams present physical barriers (large waterfalls) restricting upstream movement of fish from the rest of the system (Figure 2).

![Figure 2. Proportion of salmonid species captured in sampled streams. The size of the pie chart is proportional to the total density of fish caught in each watershed. The crosses indicate watershed without fishes. Rainbow trout (Oncorhynchus mykiss), brown trout (Salmo trutta), brook trout (Salvelinus fontinalis).](Figure%202.png) *Oncorhynchus mykiss* was present in all basins where fish were caught. This species was also the most abundant in almost all basins (31/35); *Salmo trutta*, though present in 21/35 basins, was dominant in only 4 of them (Figure 2). *Salvelinus fontinalis*, was captured in 15/35 basins, but never dominated the assemblage (Figure 2).

Co-occurrence of introduced salmonid species varied among basins. The three species were found together in 10 basins. Only two out of three possible bispecific assemblages were found: rainbow trout with brown trout (*S.trutta* +*O. mykiss*, n = 10) and brown trout with brook trout (*S.fontinalis* + *O.mykiss*, n = 4). Monospecific assemblages were found only for rainbow trout (*O. mykiss*, n = 7).

### No interspecific reciprocal influences on presence are evidenced by salmonid species distribution

Independence of species presence was tested using a contingency table approach, asking whether the probability of a species being present was contingent on the presence of other species.We calculated the expected frequency of each combination of species under the assumption that species distributions are independent of each other, based on the frequency each species was found. We then calculated the expected counts of all combinations, and compared them to the observed counts using a Fisher´s exact Test for contingency tables.

```{r}
####Contingency test on joint species presence####

#Field data: number of basins in which a given species is present
Ntotal <- 35 #Total basins
NOm <- 31 #Basins in which rainbow trout Onchorhynchus mykiss (Om) is present
NSf <- 15 #Basins in which brook trout Salvelinus fontinalis (Sf) is present
NSt <- 21 #Basins in which brown trout Salmo trutta (St) is present

#Counts of basins in which each combination of species occur
NOb <- c(4,7,0,0,4,10,0,10)
names(NOb)<-c("none","Om","Sf","St","Om.Sf","Om.St","St.Sf","Om.Sf.St")

#Marginal probabilities
pOm <- NOm/Ntotal
pSf <- NSf/Ntotal
pSt <- NSt/Ntotal

#Calculate expected frequencies as joint probabilities
cOm <- pOm - pOm*pSf*pSt -(pOm*pSf - pOm*pSf*pSt) -(pOm*pSt - pOm*pSf*pSt)
cSf <- pSf - pOm*pSf*pSt -(pOm*pSf - pOm*pSf*pSt) -(pSt*pSf - pOm*pSf*pSt)
cSt <- pSt - pOm*pSf*pSt -(pOm*pSt - pOm*pSf*pSt) -(pSt*pSf - pOm*pSf*pSt)
cOm.Sf <- pOm*pSf - pOm*pSf*pSt
cOm.St <- pOm*pSt - pOm*pSf*pSt
cSt.Sf <- pSt*pSf - pOm*pSf*pSt
cOm.Sf.St <- pOm*pSf*pSt
none <- 1-sum(cOm,cSf,cSt,cOm.Sf,cOm.St,cSt.Sf,cOm.Sf.St)

#Build a vector of expected frequencies
frExp <- c(none,cOm,cSf,cSt,cOm.Sf,cOm.St,cSt.Sf,cOm.Sf.St)
names(frExp)<-c("none","Om","Sf","St","Om.Sf","Om.St","St.Sf","Om.Sf.St")

#Plot a Venn diagram
col.scheme <- c("red","green","blue")
draw.triple.venn(pOm,pSt,pSf,pOm*pSt,pSt*pSf,pSf*pOm,pOm*pSt*pSf, c("Om","St","Sf"), fill=col.scheme, cat.col=col.scheme, print.mode="percent")

#Calculate vector of expected frequencies
NExp <- frExp*Ntotal

#Build a table of expected and observed occurrences.
expvsobs <- cbind(round(NExp),NOb)
colnames(expvsobs)<-c("Expected","Observed")
expvsobs <- as_tibble(expvsobs, rownames = "Species")
gt(expvsobs)

#Performs Fisher's exact test for testing the null of independence of rows and columns in a contingency table with fixed marginals
ftest_all_basins <- fisher.test(expvsobs %>% select(Expected, Observed))
ftest_all_basins


## Now repeat all of the above, but dropping those basins where no fish was caught.
## This explores that those basins are categorically different due to insurmountable obstacles for dispersal.
#Field data: number of basins in which a given species is present
Ntotal <- 31
NOm <- 31
NSf <- 15
NSt <- 21

#Counts of basins in which each combination of species occur
NOb <- c(7,0,0,4,10,0,10)
names(NOb)<-c("Om","Sf","St","Om.Sf","Om.St","St.Sf","Om.Sf.St")

#Marginal probabilities
pOm <- NOm/Ntotal
pSf <- NSf/Ntotal
pSt <- NSt/Ntotal

#Calculate expected frequencies as joint probabilities
cOm <- pOm - pOm*pSf*pSt -(pOm*pSf - pOm*pSf*pSt) -(pOm*pSt - pOm*pSf*pSt)
cSf <- pSf - pOm*pSf*pSt -(pOm*pSf - pOm*pSf*pSt) -(pSt*pSf - pOm*pSf*pSt)
cSt <- pSt - pOm*pSf*pSt -(pOm*pSt - pOm*pSf*pSt) -(pSt*pSf - pOm*pSf*pSt)
cOm.Sf <- pOm*pSf - pOm*pSf*pSt
cOm.St <- pOm*pSt - pOm*pSf*pSt
cSt.Sf <- pSt*pSf - pOm*pSf*pSt
cOm.Sf.St <- pOm*pSf*pSt
none <- 1-sum(cOm,cSf,cSt,cOm.Sf,cOm.St,cSt.Sf,cOm.Sf.St)

#Build a vector of expected frequencies
frExp <- c(cOm,cSf,cSt,cOm.Sf,cOm.St,cSt.Sf,cOm.Sf.St)
names(frExp)<-c("Om","Sf","St","Om.Sf","Om.St","St.Sf","Om.Sf.St")

#Plot a Venn diagram
col.scheme <- c("red","green","blue")
#draw.triple.venn(pOm,pSt,pSf,pOm*pSt,pSt*pSf,pSf*pOm,pOm*pSt*pSf, c("Om","St","Sf"), fill=col.scheme, cat.col=col.scheme, print.mode="percent")

#Calculate vector of expected frequencies
NExp <- frExp*Ntotal

#Build a table of expected and observed occurrences.

expvsobs.2 <- cbind(round(NExp),NOb) 
colnames(expvsobs.2)<-c("Expected","Observed")
expvsobs.2 <- as_tibble(expvsobs.2, rownames = "Species")
gt(expvsobs.2)

#Performs Fisher's exact test for testing the null of independence of rows and columns in a contingency table with fixed marginals
ftest_no_empty_basins <- fisher.test(expvsobs.2 %>% select(Expected, Observed))
ftest_no_empty_basins
```

Fisher's exact test failed to reject the hypothesis of independence (*p* = `r ftest_all_basins$p.value`), suggesting that species interactions are not needed to explain the frequency of each combination. Expected and observed counts are even more similar when basins without fish captures are excluded from the calculations (*p* = `r ftest_no_empty_basins$p.value`).

### Salmonid abundances varied with environmental variables.

We then used generalized linear models (GLMs) on presence/absence and relative abundance data to assess the filtering influence of landscape and local variables. For each level and response variable type, we tried two approaches: 1) reducing the dimensionality of the independent variables through a principal components analysis (PCA), and then using the principal components explaining most variance as predictor variables in the GLM; and 2) by selecting independent variables that were not significantly correlated and using them as predictor variables in the GLM. While these two approaches are expected to yield qualitatively similar results, the second approach lends to more straightforward interpretations. All analyses were run using the function `glm` from the `base` package of the R computing environment R Core Team, version 3.5.1 (2018). To regress environmental variables using presence/absence as a response variable, we used a binomial logistic regression with a logit link. When the response variable was the logarithm of relative abundance, we used a Gaussian regression with an identity link.

```{r}
#### Basin-level correlation analysis ####
basin.cpue.cor <- cor(basins[,-1], use="pairwise.complete.obs", method="spearman")[,18:21]
basin.cpue.cor.test <- rcorr(as.matrix(basins[,-1]), type="spearman") 
basin.cpue.cor.test$r[,29:32] %>%
  as_tibble(rownames = "variable") %>%
  gt()
```

Total catch of salmonids in streams from the upper Limay basin increased along a NW-SE gradient (Table 2). This gradient in relative abundance was associated to basins having a larger proportion of lowland, shrubby environments characterized by low rainfall, open woodlands and fewer rocky outcrops. This pattern in total catch was likely driven by dominance of *O. mykiss*, since its relative abundances presented the same pattern as the total catch (with the addition that abundance was higher at lower basins).

In contrast, *S. trutta* abundances were not clearly associated with geographic gradients (Table 2). Instead, higher abundances were associated with lower, warmer and flatter basins, with fewer High-Andean habitat and more wetlands. *Salvelinus fontinalis* abundance showed no significant correlations with any environmental variable. However, spotty occurrence and low overall abundance of this species resulted in very low statistical power to detect any existing correlations.

### Patterns of salmonid distribution are not strongly driven by landscape variables

Having ruled out a role for the interaction between species in their joint distribution (see above), we evaluated the influence of basin characteristics on individual species presence and abundances. We derived 28 watershed variables from remote sensing and topographical data sources.

```{r}
#### Basin-level PCA and GLM analysis ####
basin.pca <- prcomp(basins[,2:29],center = TRUE, scale. = TRUE)
summary_basin.pca <- summary(basin.pca)
biplot(basin.pca)

# Results for Variables
loadings_basin.pca <- 
get_pca_var(basin.pca)$contrib %>%
  as_tibble(rownames = "variable")

gt(loadings_basin.pca)

top.load_basin.pc1 <- 
loadings_basin.pca %>% 
  select(variable, Dim.1) %>% 
  arrange(desc(Dim.1))

top.load_basin.pc3 <- 
loadings_basin.pca %>% 
  select(variable, Dim.3) %>% 
  arrange(desc(Dim.3))



basins$p.TAI <- ifelse(basins$TAI==0,0,1)
basins$p.TAR <- ifelse(basins$TAR==0,0,1)
basins$p.TAM <- ifelse(basins$TAM==0,0,1)

fviz_pca_ind(basin.pca, geom.ind = "point", 
             col.ind = "#FC4E07", 
             axes = c(1, 2), 
             pointsize = 1.5) 

fviz_screeplot(basin.pca, choice="eigenvalue")


basins <- cbind(basins, basin.pca$x[,1:3])

total.glm<-glm(Total~PC1+PC2+PC3, data=basins)
summary(total.glm)

p.tai.glm<-glm(p.TAI~PC1+PC2+PC3, data=basins, family="binomial")
summary(p.tai.glm)

tai.glm<-glm(TAI~PC1+PC2+PC3, data=basins)
summary(tai.glm)
tai.glm<-glm(TAI~PC1+PC2+PC3, data=basins)
summary(tai.glm)
log.tai.glm<-glm(log(TAI+0.00001)~PC1+PC2+PC3, data=basins)
summary(log.tai.glm)


p.tam.glm<-glm(p.TAM~PC1+PC2+PC3, data=basins, family="binomial")
summary(p.tam.glm)
tam.glm<-glm(TAM~PC1+PC2+PC3, data=basins)
summary(tam.glm)
log.tam.glm<-glm(log(TAM+0.00001)~PC1+PC2+PC3, data=basins)
summary(log.tam.glm)

p.tar.glm<-glm(p.TAR~PC1+PC2+PC3, data=basins, family="binomial")
summary(p.tar.glm)
tar.glm<-glm(TAR~PC1+PC2+PC3, data=basins)
summary(tar.glm)
log.tar.glm<-glm(log(TAR+0.00001)~PC1+PC2+PC3, data=basins)
summary(log.tar.glm)

```

We found that many of the variables were highly correlated; thus, we used a principal component analysis (PCA) to reduce the dimensionality of variable space. The first three principal components (PC) explained `r  summary_basin.pca$importance[3,3]*100` % of the total variance (PC1 `r  summary_basin.pca$importance[2,1]*100`%; PC2 `r  summary_basin.pca$importance[2,2]*100`%, PC3 `r  summary_basin.pca$importance[2,3]*100`%).

We used these three PCs to test if basin characteristics influenced the presence of each species by fitting a logistic regression using GLMs (see Methods), but found no significant influence of either PC on presence for any of the species. We then repeated the same analysis using relative abundance (individuals caught per unit effort; CPUEN) as a dependent variable instead. We found that rainbow trout abundance was significantly influenced by PC3 (p=0.001, loaded mainly by `r top.load_basin.pc3[1,1]` and `r top.load_basin.pc3[2,1]`), while brown trout abundance was instead, significantly influenced by PC1 (p=0.002, loaded mainly by `r top.load_basin.pc1[1,1]` and `r top.load_basin.pc1[2,1]`). Brook trout was not influenced by any PCs (Table 3). Repeating the analyses using the logarithm of relative abundance as response variable yielded no significant results for any species or PCs.

Hence, for all three species, we found that the probability of a species being present in a basin was not explained by any of the basin characteristics we used in this analysis. However, we detected evidence that the abundance of rainbow trout and brown trout (but not brook trout) is influenced by different combinations of basin traits. Thus, the three species differ in their response to landscape level filtering variables.

### Local variables influence weakly but differentially the abundance of each species

To evaluate the influence of local characteristics on species presence we estimated 31 variables using local data records (see Table 3). Since several local-scale variables presented significant correlations, we used PCA to reduce the dimensionality of the variable space.

```{r}
#### Reach-level PCA and GLM analysis ####
reach<-read.table("reaches.tsv", header=TRUE, sep="\t")
reach$p.TAI <- ifelse(reach$TAI==0,0,1)
reach$p.TAR <- ifelse(reach$TAR==0,0,1)
reach$p.TAM <- ifelse(reach$TAM==0,0,1)

reach.pca <- prcomp(na.omit(reach[,2:32]),center = TRUE, scale. = TRUE)
summary_reach.pca <- summary(reach.pca)
biplot(reach.pca)

# Results for Variables
loadings_reach.pca <- 
get_pca_var(reach.pca)$contrib %>%
  as_tibble(rownames = "variable")

gt(loadings_reach.pca)

top.load_reach.pc1 <- 
loadings_reach.pca %>% 
  select(variable, Dim.1) %>% 
  arrange(desc(Dim.1))

top.load_reach.pc2 <- 
loadings_reach.pca %>% 
  select(variable, Dim.2) %>% 
  arrange(desc(Dim.2))

fviz_pca_ind(reach.pca, geom.ind = "point", 
             col.ind = "#FC4E07", 
             axes = c(1, 2), 
             pointsize = 1.5) 

fviz_screeplot(reach.pca, choice="eigenvalue")
fviz_screeplot(reach.pca, choice="variance")
fviz_contrib(reach.pca, choice="var", axes=3)

reach <- cbind(reach, reach.pca$x[,1:3]) 

r.total.glm<-glm(Total~PC1+PC2+PC3, data=reach)
summary(r.total.glm)

r.p.tai.glm<-glm(p.TAI~PC1+PC2+PC3, data=reach, family="binomial")
summary(r.p.tai.glm)

r.tai.glm<-glm(TAI~PC1+PC2+PC3, data=reach)
summary(r.tai.glm)

r.log.tai.glm<-glm(log(TAI+0.00001)~PC1+PC2+PC3, data=reach)
summary(r.log.tai.glm)


r.p.tam.glm<-glm(p.TAM~PC1+PC2+PC3, data=reach, family="binomial")
summary(r.p.tam.glm)

r.tam.glm<-glm(TAM~PC1+PC2+PC3, data=reach)
summary(r.tam.glm)

r.log.tam.glm<-glm(log(TAM+0.00001)~PC1+PC2+PC3, data=reach)
summary(r.log.tam.glm)

r.p.tar.glm<-glm(p.TAR~PC1+PC2+PC3, data=reach, family="binomial")
summary(r.p.tar.glm)

r.tar.glm<-glm(TAR~PC1+PC2+PC3, data=reach)
summary(r.tar.glm)

r.log.tar.glm<-glm(log(TAR+0.00001)~PC1+PC2+PC3, data=reach)
summary(r.log.tar.glm)
```

The first three principal components (PC) explained `r  summary_reach.pca$importance[3,3]*100` % of the total variance (PC1 `r  summary_reach.pca$importance[2,1]*100` %; PC2 `r  summary_reach.pca$importance[2,2]*100`%, PC3 `r  summary_reach.pca$importance[2,3]*100`%).

We tested whether local characteristics influenced the presence-absence of each species by fitting a logistic regression using Generalized Linear Models, and found no significant influence of either PCs on presence-absence for rainbow trout and brown trout, while PC2 (loaded mainly by water quality and slope variables) had a significant influence on presence of brook trout (z-value=-2.62, p-value=0.009). We then tested if reach variables influence relative abundances (either absolute values or their logarithms) and found a significant relation between PC1 (loaded mainly by `r top.load_reach.pc1[1,1]` and `r top.load_reach.pc1[2,1]`) and rainbow trout abundances (absolute -- t=3.86, p=0.0004 and logarithms values --t=2.94, p=0.0055), but no significant influence on brown trout. We found significant influence of PC2 (loaded mainly by `r top.load_reach.pc2[1,1]` and `r top.load_reach.pc2[2,1]`) on the logarithm of brook trout abundance (t-value=-2.97, p=0.0052) but not on the absolute values. In summary, our regression analysis showed that the influence of local traits varies across all three salmonid species.

## Discussion

One of the most pervasive concepts in the study of community assembly is the metaphor of the environmental filter, which refers to abiotic factors that prevent the establishment or persistence of species in a particular location. However, this concept has been criticized because the evidence used in many studies to assess environmental filtering is insufficient to distinguish filtering from the evolutionary outcome of historical biotic interactions [@kraftCommunityAssemblyCoexistence2015a]. In our work we took advantage of the relatively recent and well-studied history of salmonid introductions to evaluate if non-native species show different patterns of association with abiotic factors at different spatial scales of the filter.

We found widespread presence of salmonid species and an almost total absence of native species in our study area. Thus, the only expected source of current biotic interference would be interspecific interaction between the salmonid species themselves. However, the results of our contingence analysis on species distribution does not support a scenario in which any of the species is affecting the distribution of the other species. This suggests that streams in our study area have not reached carrying capacity for salmonids and that they might be partitioning the riverine habitats to minimize niche overlap, as reported in other parts of the world [@bozekSegregationResidentTrout1992; reevesFishCommunities1998; fauschParadoxTroutInvasions2008; marchettiFishInvasionsCalifornia2011].

Interspecific interference among salmonid species has been proposed in previous studies within this region [@juncosModelingPreyConsumption2013a; @arismendiDifferentialInvasionSuccess2014]; we found however no evidence for it. Thus, we can assume that interference has played only a minor role in determining current fish distribution in the region. Instead, current patterns of presence and abundance of salmonids are best explained as the product of environmental filters. This agrees with studies relating the success of salmonid invasions in southern Chile to the excellent abiotic conditions they found in the region [@pascualFreshwaterFishesPatagonia2007a; @habitEfectosInvasionSalmonidos2015; @habitNativeIntroducedFish2012].

Biological invasions are inherently complex. A successful invader must survive a series of events: transport to the invasion site, initial establishment, spread to a broad area, and then integration into the existing biotic community [@moyleBiologicalInvasionsFresh1996; @kolarProgressInvasionBiology2001] . Not surprisingly, most introduced species fail to become established and never reach invasive status [@moyleBiologicalInvasionsFresh1996; @arismendiDifferentialInvasionSuccess2014]. Our results suggest that in North Patagonia, biotic resistance from native fish species seems to have had little or no influence on the invasion process by introduced salmonid species, and that success of invaders in the face of low odds is related, as we previously suggested, mostly to the presence of favorable environments, such as adequate flow regimes (conditioned for the rainfall gradient) and food availability [@lallementLandscapeFactorsModulating], added to the trophic superiority that the juveniles present in lotic systems.

In contrast to other reports [@marchettiAlienFishesCalifornia2004; @stanfieldUsingLandscapeApproach2006], we saw no evidence that presence/absence patterns of salmonid distribution were strongly driven by landscape variables, except for those basins with environmental barriers. However, when analyzing responses of relative abundances (CPUEN), the influence of climatic and geomorphological variables (e.g., precipitation and relief) became more evident. These two types of factors have been mentioned in other systems as determinants of salmonid distribution [@stanfieldUsingLandscapeApproach2006; @warrenRiverFlowDeterminant2015a] : rainfall and geology have a direct influence on stream discharge and are thus determinant during early development of salmonid life cycles [@heggenesDownstreamMigrationCritical1988; @nehringDeterminationPopulationlimitingCritical1993a]. Determining the relative influence of landscape and habitat features seems likely to remain a difficult problem because their influences may be inextricably linked in most situations.

Landscape characteristics (e.g., general slope of the valley and geomorphological aspects) determine local river section traits such as substrate composition, pool dimensions and refuge availability, which in turn strongly correlate with the structure and distribution of the assemblages of fish in a basin [@fischerHabitatRelationshipsFish2008; @roweNaturalResourceEcology2009]. In our study area, we found evidence that some local traits modulate *O. mykiss* abundance but do not explain abundances of *S. trutta* and *S. fontinalis*, or the presence-absence patterns for all three salmonid species. Low abundances for a species could be causing diminished statistical power to detect the influence of environmental variables; this could be affecting our results for brook trout. Differential abundances are nonetheless likely to result from differential responses to the same environment by each species. Thus, the layered influence of environmental filters was reflected in a weak but differential influence of local traits on abundance of each salmonid species.

Habitat suitability for salmonids is often controlled by local variables, such as temperature regime [@rahelSpatialPatternsRelations1999a; @harigMinimumHabitatRequirements2002a; @colemanColdSummerTemperature2007a], flow regime [@strangeInteractionPhysicalBiological1999; @fauschFloodDisturbanceRegimes2001], stream size [@rahelSpatialPatternsRelations1999a] and habitat factors correlated with stream gradient and channel geomorphology [@fauschGradientTemperatureAffect1989; @montgomeryChannelTypeSalmonid1999]. Due to the steep precipitation gradient in our study area, several streams originate in wooded areas and cross wide valleys where shrubby vegetation typical of arid steppes predominates. Shrubby riverbanks result in higher solar irradiation and air temperatures, favoring higher primary production of the periphyton and sustaining an important biomass of macroinvertebrates [@miserendinoMacroinvertebrateFunctionalOrganization2007; @modenuttiStructureDynamicFood2010]. It is within these streams where we found higher fish abundances.

Our results are interesting in light of other studies that have tried to identify the relative importance of different process scales in structuring biotic assemblages. Previous predictive modeling studies have indicated that landscape-scale watershed characteristics explain better fish distributions than reach-scale characteristics [@crequeUseGISDerivedLandscapeScale2005; @frimpongSpatialscaleEffectsRelative2005]. However, our study did not find that watershed-scale variables were significantly better at explaining or predicting fish distributions in North Patagonian streams. This could be due to a lack of habitat saturation by fishes resulting from temporal variability in fish distributions, to us failing to measure the reach- and watershed-scale variables actually driving distribution, or to an insufficient sample size. As @stanfieldUsingLandscapeApproach2006, we do not contend that landscape variables are the most important for salmonids, but suggest that landscape traits do condition the range of geomorphological variation inside a watershed that ultimately defines the present local abundance at the reach level [@lallementLandscapeFactorsModulating]. In any case, further information is still needed to fully understand how the variability of spatial scale affects the distribution of fishes in streams of Patagonia.

Even though restoring streams to the conditions prior to the introductions is not feasible due to the wide distribution and dominance of salmonids at present, a possible strategy for conservation would be to focus the efforts on particular environments still devoid of salmonids. The existence of barriers that prevent salmonid colonization of headwaters has been shown to lead to different biota assemblages [@buriaMovementSouthAmerican2007a; @albarinoAlteredMayflyDistribution2011a]. Given our results, a possible strategy would be to determine the effect of differential exclusions on the stream biota, as well as the effect of such exclusions measured on the general pool of salmonids. Thus, if it is found that the fishing stock depends on sourcing from a few basins, management efforts could concentrate in those sources.

Although not explored in this study, distributions of fishes are variable and may be regulated by seasonal movements and the frequency and duration of stochastic flow cycles. In any case, it is important to bear in mind that the results obtained in regions with different histories of colonization and introduction are not necessarily extrapolatable. From a management perspective, our results suggest that considering the pristine (or near-pristine) condition of the streams sampled here, the relationships observed between fishes and landscape variables can be used, for example, as a reference for further studies addressing the effects of human modifications on aquatic biodiversity of North Patagonia. We believe that our findings expand our current understanding about how the combination of factors (habitat template) across different scales structure aquatic assemblages within Patagonia and can be used to strategically guide future management actions.

## Acknowledgments

We thank Alejandro Sosnovsky and Patricio Macchi for their comments on an earlier draft, and to the National Park Administration (APN) that through the Biodiversity Information System (SIB) provided us with the data for Use of Land and Vegetation in watersheds. We thank all the members of the Grupo de Evaluación y Manejo de Recursos Icticos (GEMaRI) for field assistance. Funding was provided by the Agencia Nacional de Promoción de Ciencia y Tecnología, Argentina (PICT projects 016 and 2959). The authors declare no conflict of interest.

## Data Availability Statement

The data and code with the analyses supporting our findings are available at <https://github.com/ezattara/patagonian_salmonid_distribution>

## Author Contributions

Conceptualization: MEL, EEZ; data curation: MEL, EEZ; formal analysis: MEL, EEZ; investigation: MEL, EEZ, MR; visualization: MEL, MR; writing -- original draft: MEL, EEZ; writing -- review & editing: MEL, EEZ, MR.

## References
